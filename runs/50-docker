#!/bin/bash
# runs/docker - Docker and container tools

sudo pacman -S --needed --noconfirm \
    docker \
    docker-compose \
    docker-buildx

# Install lazydocker from AUR
paru -S --needed --noconfirm --skipreview \
    lazydocker

# Enable docker service (will start on boot)
sudo systemctl enable docker || echo "Note: systemctl enable may fail in chroot - docker will be enabled on first boot"

# Add current user to docker group
TARGET_USER="${SUDO_USER:-$USER}"
if [ -n "$TARGET_USER" ] && [ "$TARGET_USER" != "root" ]; then
    sudo usermod -aG docker "$TARGET_USER"
    echo "âœ“ User $TARGET_USER added to docker group"
    echo "Note: Log out and back in for group changes to take effect"
fi

echo "Docker installed successfully!"
