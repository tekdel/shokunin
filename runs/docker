#!/bin/bash
# runs/docker - Docker and container tools

sudo pacman -S --needed --noconfirm \
    docker \
    docker-compose \
    docker-buildx

# Install lazydocker from AUR
paru -S --needed --noconfirm --skipreview \
    lazydocker

# Enable docker service (will start on boot)
sudo systemctl enable docker || echo "Note: systemctl enable may fail in chroot - docker will be enabled on first boot"

# Add current user to docker group
if [ -n "$SUDO_USER" ]; then
    sudo usermod -aG docker "$SUDO_USER"
    echo "User $SUDO_USER added to docker group"
    echo "Note: Log out and back in for group changes to take effect"
elif [ -n "$USER" ]; then
    sudo usermod -aG docker "$USER"
    echo "User $USER added to docker group"
    echo "Note: Log out and back in for group changes to take effect"
fi

echo "Docker installed successfully!"
